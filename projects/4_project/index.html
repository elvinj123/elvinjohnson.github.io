<!DOCTYPE html>
<html lang="en">

  <head>
    
    <meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta http-equiv="X-UA-Compatible" content="IE=edge">

<title>Elvin Johnson | Deepfakes</title>
<meta name="description" content="A simple, whitespace theme for academics. Based on [*folio](https://github.com/bogoli/-folio) design.
">

<!-- Open Graph -->


<!-- Bootstrap & MDB -->
<link href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css" rel="stylesheet" integrity="sha512-MoRNloxbStBcD8z3M/2BmnT+rg4IsMxPkXaGh2zD6LGNNFE80W3onsAhRcMAMrSoyWL9xD7Ert0men7vR8LUZg==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/css/mdb.min.css" integrity="sha512-RO38pBRxYH3SoOprtPTD86JFOclM51/XTIdEPh5j8sj4tp8jmQIx26twG52UaLi//hQldfrh7e51WzP9wuP32Q==" crossorigin="anonymous" />

<!-- Fonts & Icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.14.0/css/all.min.css"  integrity="sha512-1PKOgIY59xJ8Co8+NE6FZ+LOAZKjy+KY8iq0G4B3CyeY6wYHN3yt9PW0XpSriVlkMXe40PTKnXrLnZ9+fkDaog==" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/academicons/1.9.0/css/academicons.min.css" integrity="sha512-W4yqoT1+8NLkinBLBZko+dFB2ZbHsYLDdr50VElllRcNt2Q4/GSs6u71UHKxB7S6JEMCp5Ve4xjh3eGQl/HRvg==" crossorigin="anonymous">
<link rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons">

<!-- Code Syntax Highlighting -->
<!-- <link rel="stylesheet" href="https://gitcdn.xyz/repo/jwarby/jekyll-pygments-themes/master/github.css" /> -->
<link rel="stylesheet" href="/elvin_johnson.github.io/assets/css/github.css" >
<!-- Styles -->

<link rel="icon" href="data:image/svg+xml,<svg xmlns=%22http://www.w3.org/2000/svg%22 viewBox=%220 0 100 100%22><text y=%22.9em%22 font-size=%2290%22></text></svg>">

<link rel="stylesheet" href="/elvin_johnson.github.io/assets/css/main.css">
<link rel="canonical" href="/elvin_johnson.github.io/projects/4_project/">

<!-- JQuery -->
<!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>


<!-- Theming-->

<script src="/elvin_johnson.github.io/assets/js/theme.js"></script>
<script src="/elvin_johnson.github.io/assets/js/dark_mode.js"></script>






  </head>

  <body class="fixed-top-nav ">

    <!-- Header -->

    <header>

  <!-- Nav Bar -->
  <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top">
  <div class="container">
    
    <a class="navbar-brand title font-weight-lighter" href="https://elvin_johnson.github.io/elvin_johnson.github.io/">
     Elvin Johnson
    </a>
    
    <!-- Navbar Toggle -->
    <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation">
      <span class="sr-only">Toggle navigation</span>
      <span class="icon-bar top-bar"></span>
      <span class="icon-bar middle-bar"></span>
      <span class="icon-bar bottom-bar"></span>
    </button>
    <div class="collapse navbar-collapse text-right" id="navbarNav">
      <ul class="navbar-nav ml-auto flex-nowrap">
        <!-- About -->
        <li class="nav-item ">
          <a class="nav-link" href="/elvin_johnson.github.io/">
            About
            
          </a>
        </li>
        
        <!-- Blog -->
        <!-- <li class="nav-item ">
          <a class="nav-link" href="/elvin_johnson.github.io/blog/">
            blog
            
          </a>
        </li> -->
        
        <!-- Other pages -->
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        <li class="nav-item ">
            <a class="nav-link" href="/elvin_johnson.github.io/courses/">
              Courses
              
            </a>
        </li>
        
        
        
        <li class="nav-item ">
            <a class="nav-link" href="/elvin_johnson.github.io/Internships/">
              Internships
              
            </a>
        </li>
        
        
        
        
        
        <li class="nav-item ">
            <a class="nav-link" href="/elvin_johnson.github.io/projects/">
              Projects
              
            </a>
        </li>
        
        
        
        <li class="nav-item ">
            <a class="nav-link" href="/elvin_johnson.github.io/publications/">
              Publications
              
            </a>
        </li>
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
        
          <div class="toggle-container">
            <a id="light-toggle">
                <i class="fas fa-moon"></i>
                <i class="fas fa-sun"></i>
            </a>
          </div>
        
      </ul>
    </div>
  </div>
</nav>

</header>


    <!-- Content -->

    <div class="container mt-5">
      <div class="post">

  <header class="post-header">
    <h1 class="post-title">Deepfakes</h1>
    <p class="post-description">Detecting Deepfakes videos using Deep Learning</p>
  </header>

  <article>
    <p>Deepfakes are videos in which a persons face is swapped with that of another person or another persons lip movements are transfered to that of another using various techniques. Using this, a person can be made to say anything, provided a few pictures of the person targeted are available, thus, allowing a person to defame the targeted individual. Deepfakes videos can be particularly dangerous when it comes to politics. The following is an illustration of how lip sync and faceswap can be used to create Deep fakes.</p>

<div class="row justify-content-sm-center">
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/elvin_johnson.github.io/assets/img/putin%20deepfake.gif" alt="" title="example image">
        <div class="caption">
            FIGURE 1: LIP SYNC DEEPFAKE
        </div>
    </div>
    <div class="col-sm mt-3 mt-md-0">
        <img class="img-fluid rounded z-depth-1" src="/elvin_johnson.github.io/assets/img/nicolas%20cage%20deepfake.gif" alt="" title="example image">
        <div class="caption">
            FIGURE 2: FACESWAP DEEPFAKE
        </div>
    </div>
</div>
<p>The following is a deepfake video of former president Barack Obama. In this video, he was made to say dishonorable things by means of transfering the lip movements of another person onto his.</p>
<div class="row justify-content-sm-center">
    <div class="col-sm mt-3 mt-md-0">
        <!-- <video width="320" height="240" autoplay muted> -->
        <center>
            <video width="500" height="350" controls="">
                <source class="img-fluid rounded z-depth-1" src="/elvin_johnson.github.io/assets/img/obama%20actual%20fake.mp4" type="video/mp4"></source>
            </video> 
        </center>
    </div>
</div>
<div class="caption">
    VIDEO 1: OBAMA DEEPFAKE
</div>
<p>Before being able to work on detection, we had to understand Generative Advarsarial Networks (GANS), which was one the major recent breakthroughs in deep learning that was misused to create deepfake videos. The following grid of images consists of human faces that never existed, which we generated using GANS. The NVIDIA DGX-1 AI SUPERCOMPUTER was used for this.</p>
<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <img height="500" class="img-fluid rounded z-depth-1" src="/elvin_johnson.github.io/assets/img/gans1.JPG" alt="" title="example image">
        <div class="caption">
        FIGURE 3: GRID OF GENERATED FACES
        </div>
    </div>
    <div class="col-sm mt-3 mt-md-0">
        <img height="200" class="img-fluid rounded z-depth-1" src="/elvin_johnson.github.io/assets/img/gans2.JPG" alt="" title="example image">
        <div class="caption">
        FIGURE 4: GRID OF GENERATED FACES
        </div>
    </div>

</div>

<p>My main task was to preprocess the data, get it ready and to build the detection model. I also took lead in preparing a <a href="https://ieeexplore.ieee.org/abstract/document/9225400" target="_blank" rel="noopener noreferrer">research paper </a> for the same and presented it at the 11th International Conference on Computing, Communication and Networking Technologies (ICCCNT) 2020, held at Indian Institute of Technology, Kharagpur.</p>

<h5><b>Dataset Creation</b></h5>
<p>Considering the fact that deepfakes were being created via many sophisticated methods, it was important for the model to be able to identify and to be able to generalize to all of these. Hence, for dataset creation we processed, cleaned and mixed about a <b>million</b> frames from deep fake datasets by Facebook, FaceForensics, Google to use as the training dataset. Faces had to be extracted from each frame of a video. DLIB (deep learning based face detection) and MTCNN (deep learning based face detection) were used for this. Due to the sheer size of the data, processing the entire dataset took more than a week on the NVIDIA DGX-1 Supercomputer.</p>

<h5><b>Training Procedure</b></h5>
<p>To foster better performance and to reduce training time, transfer learning was used. In transfer learning, the data in the source and target domain are not required to be identically distributed i.e the model in target domain need not be trained from scratch, which can significantly reduce the demand of training data and training time. Also, transfer learning also implies that the knowledge gained in the source domain would be transferred to the target domain, thus, helping the model achieve better accuracy in the target domain. Hence, transfer learning was used.</p>

<p>Using the master dataset created as above, a number of different custom CNN based models were created and trained by using different base models. Base models like those of the InceptionV3, ResNet50, etc., were used. As part of employing transfer learning, the initial starting weights were those obtained by training these models on the ImageNet dataset (A dataset containing images several images belonging to 1000 categories). Several custom layers were then added to these base models and their weights were randomly initialized. Training was performed on the NVIDIA DGX-1 AI SUPERCOMPUTER, that hosted 8 Tesla V100 GPU’s, in the lab I was working in. A generalized model was thus created. This project also resulted in a <a href="publication">publication</a>. Figure 5 and Figure 6 show the DGX-1 setup.</p>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <img height="500" class="img-fluid rounded z-depth-1" src="/elvin_johnson.github.io/assets/img/dgx1_adobespark(1).jpg" alt="" title="example image">
        <div class="caption">
        FIGURE 5: THE NVIDIA DGX-1
        </div>
    </div>
    <div class="col-sm mt-3 mt-md-0">
        <img height="200" class="img-fluid rounded z-depth-1" src="/elvin_johnson.github.io/assets/img/dgx2_adobespark.jpg" alt="" title="example image">
        <div class="caption">
        FIGURE 6: OVERNIGHT TRAINING ON THE DGX-1
        </div>
    </div>

</div>
<p>The following are deepfake videos tested on the final model. As seen in the top left corner, the model indicates the probability of each frame of the video being fake, the prediction is correct here.</p>

<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <center>
            <video width="500" height="350" controls="">
                <source class="img-fluid rounded z-depth-1" src="/elvin_johnson.github.io/assets/img/Obama_Final.mp4" type="video/mp4"></source>
            </video> 
        </center>
    </div>
</div>
<div class="caption">
    VIDEO 2: OBAMA DEEPFAKE DETECTED BY THE MODEL
</div>

<p>Following is a deep fake video of Jeff Bezos and Elon Musk. Their faces have been morphed/swapped into characters from the clip for the movie Star Trek. The model was correctly able to detect this as well.</p>
<div class="row">
    <div class="col-sm mt-3 mt-md-0">
        <center>
            <video width="500" height="350" controls="">
                <source class="img-fluid rounded z-depth-1" src="/elvin_johnson.github.io/assets/img/Musk%20bezos.mp4" type="video/mp4"></source>
                <!-- <source class="img-fluid rounded z-depth-1" src="/elvin_johnson.github.io/assets/img/Jeremy_Boris_Final.mp4" type="video/mp4"> -->
            </video> 
        </center>
    </div>
</div>
<div class="caption">
    VIDEO 2: MUSK-BEZOS DETECTED BY THE MODEL
</div>

<h5><b>Key takeaways</b></h5>
<ol>
  <li>I learnt a lot about <b>handling data in this project due to the sheer magnitude of the data</b> we had to use. A lot of time had to be devoted to this. Initially only 2 datasets were used, however later, to improve accuracy, newer ones had to incorporated. Since, processing the data would take more than a week (the supercomputer would remain onn for an entire week), debugging and saving current data had to be taken care of. For eg, twice during the processing, the machine had shut down due to power outages and writing code to resume from where it was cutoff was critical.</li>
  <li>Detecting deepfakes is a critical task. Deepfakes can create political unrest and spread misinformation. <b>For such critical applications, it is better to train multiple models</b> (if accuracy is around 85%-90%). In this way, mulitple models could vote on an output and avoid false negatives and false positives.</li>
  <li>
<b>Detailed research of current methods is important.</b> Deep fakes are ever evolving and newer and newer methods for generating them are being invented day after day. Hence, it is important to build machine learning models with this in mind.</li>
  <li>
<b>The more the data, better is the reliability of models.</b> In this project, 3 different datasets were mixed, thus, helping in the creation of a reliable model.</li>
  <li>
<b>Documenting progress is very important.</b> It always helps keep a tab on what had not worked and not worked earlier during the project. This helps save valuable time later on.</li>
</ol>


  </article>

</div>

    </div>

    <!-- Footer -->

    
<footer class="fixed-bottom">
  <div class="container mt-0">
    © Copyright 2021 Elvin  Johnson.
    Powered by <a href="http://jekyllrb.com/" target="_blank" rel="noopener noreferrer">Jekyll</a> 

    
    
  </div>
</footer>



  </body>

  <!-- jQuery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.5.1/jquery.min.js" integrity="sha512-bLT0Qm9VnAYZDflyKcBaQ2gg0hSYNQrJ8RilYldYQ1FxQYoCLtUjuuRuZo+fjqhx/qtq/1itJ0C2ejDxltZVFg==" crossorigin="anonymous"></script>

  <!-- Bootsrap & MDB scripts -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/2.4.4/umd/popper.min.js" integrity="sha512-eUQ9hGdLjBjY3F41CScH3UX+4JDSI9zXeroz7hJ+RteoCaY+GP/LDoM8AO+Pt+DRFw3nXqsjh9Zsts8hnYv8/A==" crossorigin="anonymous"></script>
<script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha512-M5KW3ztuIICmVIhjSqXe01oV2bpe248gOxqmlcYrEzAvws7Pw3z6BK0iGbrwvdrUQUhi3eXgtxp5I8PDo9YfjQ==" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mdbootstrap/4.19.1/js/mdb.min.js" integrity="sha512-Mug9KHKmroQFMLm93zGrjhibM2z2Obg9l6qFG2qKjXEXkMp/VDkI4uju9m4QKPjWSwQ6O2qzZEnJDEeCw0Blcw==" crossorigin="anonymous"></script>

  
<!-- Mansory & imagesLoaded -->
<script defer src="https://unpkg.com/masonry-layout@4/dist/masonry.pkgd.min.js"></script>
<script defer src="https://unpkg.com/imagesloaded@4/imagesloaded.pkgd.min.js"></script>
<script defer src="/elvin_johnson.github.io/assets/js/mansory.js" type="text/javascript"></script>


  


<!-- Medium Zoom JS -->
<script src="https://cdn.jsdelivr.net/npm/medium-zoom@1.0.6/dist/medium-zoom.min.js" integrity="sha256-EdPgYcPk/IIrw7FYeuJQexva49pVRZNmt3LculEr7zM=" crossorigin="anonymous"></script>
<script src="/elvin_johnson.github.io/assets/js/zoom.js"></script>


<!-- Load Common JS -->
<script src="/elvin_johnson.github.io/assets/js/common.js"></script>

  
<!-- MathJax -->
<script type="text/javascript">
  window.MathJax = {
    tex: {
      tags: 'ams'
    }
  };
</script>
<script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.0/es5/tex-mml-chtml.js"></script>
<script defer src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>


  





</html>
